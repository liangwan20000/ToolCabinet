<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> </title>
    <style>
        .box {
            width: 100px;
            height: 100px;
            background-color: lime;
        }
    </style>
</head>
<body>
    <div class="box"></div>
    <script>
        let obj = {
            name: 'zhangsan',
            handler: function () {
                console.log(this.name)
            }
        }
        function objTwo () {
            console.log(this.name)
        }
        function setHandle (item) {
            let newObj = Object.create(item)
            newObj.applyTwo = function (that) {
                that.fn = item
                that.fn()
                delete that.fn
            }
            return newObj
        }
        objTwo = setHandle(objTwo)
        objTwo.applyTwo(obj)

        function PromiseM(){
            this.status = 'pending';
            this.msg = '';
            var process = arguments[0];
            var that = this;
            process(function () {
                that.status = 'resolve';
                that.msg = arguments[0];
                console.log(that.msg)
            }, function () {
                that.status = 'reject';
                that.msg = arguments[1];
            });
            return this;
        }
        PromiseM.prototype.then = function () {
            if (this.status == 'resolve') {
                arguments[0](this.msg);
            }
            if (this.status == 'reject' && arguments[1]) {
                arguments[1](this.msg);
            }
        }
        //测试用例
        var mm = new PromiseM(function (resolve, reject) {
            resolve('123');//123其实就是第二个arguments[0]
        });//上面的第一个arguments[0]
        console.log(mm)
        mm.then(function (success) {
            console.log(success);//该success其实就是上面的this.msg
            console.log("ok!");
        }, function () {
            console.log('fail!');
        });
    </script>
</body>
</html>
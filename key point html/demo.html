<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		<title>Document</title>
	</head>
	<body>
		<img id="123" src="./123.jpg" alt="">
		<script>
			// 获取标签
				var body = document.querySelector('body');
				var input = document.createElement('input');
				// 读取标签添加名字
				input.type = 'file';
				// 读取标签
				var style = document.querySelector('style');
				var cutAvater = '';
				// 设置上传事件
				input.onchange = function (event) {
						
						console.log(event)
						// event.target.formAction = './七宝宝龙商户关联业态.xls'
						// 获取上传文件
						var file = this.files[0];
						console.log(file)
						// 创建读取器
						var reader = new FileReader();
						// 传入一个参数对象即可得到基于该参数对象的文本内容
						reader.readAsDataURL(file);
						console.log(reader)
						// 读取完毕触发事件
						reader.onload = function () {
								let ura = reader.result
								console.log(ura)
								// 获取结果
								let arr = ura.split(',')
								console.log(arr)
								let data = window.atob(arr[1])
								let mime = arr[0].match(/:(.*?);/)[1]
								let ia = new Uint8Array(data.length)
								for (var i = 0; i < data.length; i++) {
										ia[i] = data.charCodeAt(i)
								}
								// 声明blob对象
								let streamData = new Blob([ia], { type: 'application/octet-stream' });
								// 创建隐藏的可下载链接
								let link = document.createElement('a');
								// 下载文件名称
								link.download = '模板.xls';
								// 字符内容转变为blob地址
								link.href = window.URL.createObjectURL(streamData);
								// 触发点击
								document.body.appendChild(link);
								link.click();
						}
				};
				body.appendChild(input);
				input.onchange()
		</script>
	</body>
</html>
